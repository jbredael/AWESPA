# Operational constraints and optimization bounds
# Limits and constraints for AWE system operation

# Simulation settings
sim_settings:
  force_or_speed_control: 'force'  # control mode: 'force' or 'speed'
  time_step_RO: 0.25  # s - time step for reel-out phase
  time_step_RI: 0.25  # s - time step for reel-in phase  
  time_step_RIRO: 0.25  # s - time step for transition phases

# Optimization bounds and constraints
bounds:
  # Flight path parameters
  avg_elevation:  # Average elevation angle during reel out [deg]
    min: 20
    max: 60
    
  max_azimuth:  # Maximum azimuth angle during reel out [deg]
    min: 10
    max: 45
    
  relative_elevation:  # Maximum elevation relative to average [deg]
    min: 5
    max: 30

  # Force and speed limits
  force_limits:  # Tether force limits [kgf] - vendor expects kgf, not N
    min: 20  # ~200N when converted by vendor (20 * 9.806)
    max: 500  # ~5000N when converted by vendor (500 * 9.806)
    
  speed_limits:  # Reeling speed limits [m/s]
    min: 2.0
    max: 15.0

  # Tether length constraints
  tether_length:  # Tether length bounds [m]
    min: 200  # Ensure sufficient altitude
    max: 400
    
  # Tether stroke (reel-out distance)
  tether_stroke:  # Reel out distance [m]
    min: 50
    max: 150  # Reduced to avoid excessive heights
    
  # Minimum tether length at start of reel-out
  minimum_tether_length:  # Tether length at start of reel-out [m]
    min: 200  # Increased to ensure positive heights
    max: 250
    
# Operational constraints
operational_limits:
  # Environmental limits
  max_wind_speed: 25.0  # m/s - maximum operational wind speed
  min_wind_speed: 3.0   # m/s - minimum operational wind speed
  max_turbulence_intensity: 0.3  # maximum turbulence intensity
  
  # Safety constraints
  ground_clearance: 100  # m - minimum ground clearance
  no_fly_zones: []  # list of no-fly zone definitions
  
  # Performance constraints
  min_power_output: 1000  # W - minimum viable power output
  max_cycle_duration: 300  # s - maximum cycle duration

# Optimization settings
optimization:
  max_iterations: 50  # maximum optimization iterations  
  convergence_tolerance: 1e-4  # convergence tolerance
  initial_guess_strategy: "conservative"  # initial guess strategy

# Constraints for optimization
constraints:
  # Default constraints
  force_out_setpoint_min: 
    enabled: true
  force_in_setpoint_max:
    enabled: true
  ineq_cons_traction_max_force:
    enabled: true
  ineq_cons_min_tether_length:
    enabled: true
  ineq_cons_max_tether_length:
    enabled: true

  # Parametric constraints
  ineq_cons_cw_patterns:
    enabled: true
    min_patterns: 1  # Minimum number of crosswind patterns [-]
  ineq_cons_max_elevation:  
    enabled: true
    max_elevation: 80  # Maximum elevation angle [deg]
  ineq_cons_max_course_rate:
    enabled: true
    max_course_rate: 0.5  # Maximum course rate [rad/s]
  ineq_cons_min_height:
    enabled: true
    min_height: 50  # Minimum ground clearance [m]

# Optimization variables
opt_variables:
  F_RO:  # Average force during reel-out [kgf] - vendor expects kgf
    enabled: true
    init_value: 100  # ~1000N when used by vendor - higher for more power
    unit: kgf
  F_RI:  # Average force during reel-in [kgf] - vendor expects kgf
    enabled: true
    init_value: -20  # ~-200N when used by vendor - lower magnitude
    unit: kgf
  average_elevation:  # Average elevation angle during reel-out [deg]
    enabled: true
    init_value: 35  # Lower angle for better power generation
  relative_elevation:  # Relative elevation angle during reel-out [deg]
    enabled: true
    init_value: 10  # Reduced for stable operation
  maximum_azimuth:  # Maximum azimuth angle [deg]
    enabled: true
    init_value: 25  # Reduced cone width
  tether_stroke:  # Reel out distance [m]
    enabled: true
    init_value: 100  # Conservative stroke distance
  minimum_tether_length:  # Tether length at start of reel-out [m]
    enabled: true
    init_value: 150  # Start at reasonable altitude